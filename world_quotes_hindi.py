import os
from datetime import datetime
from openai import OpenAI
import requests
from dotenv import load_dotenv

# Load environment variables
load_dotenv()

class WorldQuotesHindi:
    def __init__(self):
        # OpenAI setup
        self.openai_client = OpenAI(api_key=os.getenv('OPENAI_API_KEY'))
        
        # Facebook setup
        self.facebook_access_token = os.getenv('FACEBOOK_ACCESS_TOKEN')
        self.facebook_page_id = os.getenv('FACEBOOK_PAGE_ID')
    
    def get_world_famous_quote_hindi(self):
        """Generate world famous quotes in Hindi with image suggestions"""
        today = datetime.now().strftime("%d %B %Y")
        
        prompt = f"""рдЖрдк рдПрдХ рдкреНрд░реЗрд░рдгрд╛рджрд╛рдпрдХ рд╡рдХреНрддрд╛ рд╣реИрдВ рдЬреЛ рджреБрдирд┐рдпрд╛ рдХреЗ рдорд╣рд╛рди рдиреЗрддрд╛рдУрдВ, рд╡реИрдЬреНрдЮрд╛рдирд┐рдХреЛрдВ, рдФрд░ рд╡рд┐рдЪрд╛рд░рдХреЛрдВ рдХреЗ рдкреНрд░рд╕рд┐рджреНрдз рдЙрджреНрдзрд░рдгреЛрдВ рдХреЛ рд╣рд┐рдВрджреА рдореЗрдВ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВред

рдЖрдЬ ({today}) рдХреЗ рд▓рд┐рдП рдПрдХ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдкреНрд░реЗрд░рдХ рдкреЛрд╕реНрдЯ рдмрдирд╛рдПрдВ рдЬрд┐рд╕рдореЗрдВ рд╡рд┐рд╢реНрд╡ рдкреНрд░рд╕рд┐рджреНрдз рдЙрджреНрдзрд░рдг рд╣рд┐рдВрджреА рдореЗрдВ рд╣реЛ!

рдЖрдкрдХреА рдкреЛрд╕реНрдЯ рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП:

1. **рд╡рд┐рд╢реНрд╡ рдкреНрд░рд╕рд┐рджреНрдз рд╡реНрдпрдХреНрддрд┐рддреНрд╡ рд╕реЗ рдЙрджреНрдзрд░рдг** (рд╣рд┐рдВрджреА рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХреЗ рд╕рд╛рде):
   - рдорд╣рд╛рди рдиреЗрддрд╛: рдиреЗрд▓реНрд╕рди рдордВрдбреЗрд▓рд╛, рдорд╛рд░реНрдЯрд┐рди рд▓реВрдерд░ рдХрд┐рдВрдЧ, рдорд╣рд╛рддреНрдорд╛ рдЧрд╛рдВрдзреА, рдЕрдмреНрд░рд╛рд╣рдо рд▓рд┐рдВрдХрди
   - рдкреНрд░рд╕рд┐рджреНрдз рд╡реИрдЬреНрдЮрд╛рдирд┐рдХ: рдЕрд▓реНрдмрд░реНрдЯ рдЖрдЗрдВрд╕реНрдЯреАрди, рд╕реНрдЯреАрдлрди рд╣реЙрдХрд┐рдВрдЧ, рдореИрд░реА рдХреНрдпреВрд░реА, рдирд┐рдХреЛрд▓рд╛ рдЯреЗрд╕реНрд▓рд╛
   - рдорд╣рд╛рди рд╡рд┐рдЪрд╛рд░рдХ: рд╕реБрдХрд░рд╛рдд, рдЕрд░рд╕реНрддреВ, рдХрдиреНрдлреНрдпреВрд╢рд┐рдпрд╕, рд░реВрдореА
   - рд╕рдорд╛рдЬ рд╕реБрдзрд╛рд░рдХ: рдорджрд░ рдЯреЗрд░реЗрд╕рд╛, рд╕реНрд╡рд╛рдореА рд╡рд┐рд╡реЗрдХрд╛рдирдВрдж, рдбреЙ. рдмреА.рдЖрд░. рдЕрдВрдмреЗрдбрдХрд░

2. **рд╡рд┐рд╖рдп** (рдХреЛрдИ рдПрдХ рдЪреБрдиреЗрдВ):
   - рд╕рд╛рд╣рд╕ рдФрд░ рджреГрдврд╝рддрд╛
   - рдЬреНрдЮрд╛рди рдФрд░ рд╢рд┐рдХреНрд╖рд╛
   - рд╕рдлрд▓рддрд╛ рдФрд░ рдореЗрд╣рдирдд
   - рдкреНрд░реЗрдо рдФрд░ рдХрд░реБрдгрд╛
   - рдиреНрдпрд╛рдп рдФрд░ рд╕рдорд╛рдирддрд╛
   - рдирд╡рд╛рдЪрд╛рд░ рдФрд░ рдЦреЛрдЬ
   - рдЖрддреНрдо-рд╡рд┐рд╢реНрд╡рд╛рд╕ рдФрд░ рдЖрдВрддрд░рд┐рдХ рд╢рдХреНрддрд┐

3. **рдкреЛрд╕реНрдЯ рдХреА рд╕рдВрд░рдЪрдирд╛**:
   - рдПрдХ рдЖрдХрд░реНрд╖рдХ рд╢реБрд░реБрдЖрддреА рдкрдВрдХреНрддрд┐ (рд╣рд┐рдВрджреА рдореЗрдВ)
   - рдореВрд▓ рдЙрджреНрдзрд░рдг рдЕрдВрдЧреНрд░реЗрдЬреА рдореЗрдВ (рдЙрджреНрдзрд░рдг рдЪрд┐рд╣реНрдиреЛрдВ рдореЗрдВ)
   - рдЙрджреНрдзрд░рдг рдХрд╛ рд╣рд┐рдВрджреА рдЕрдиреБрд╡рд╛рдж
   - рд╡реНрдпрдХреНрддрд┐ рдХрд╛ рдирд╛рдо рдФрд░ рдЙрдирдХреА рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдкрд╣рдЪрд╛рди
   - 2-3 рдкрдВрдХреНрддрд┐рдпреЛрдВ рдореЗрдВ рдкреНрд░реЗрд░рдХ рд╡рд┐рдЪрд╛рд░
   - рдЫрд╡рд┐ рд╕реБрдЭрд╛рд╡: рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреА рдЫрд╡рд┐ рдЗрд╕ рдЙрджреНрдзрд░рдг рдХреЗ рд╕рд╛рде рдЕрдЪреНрдЫреА рд▓рдЧреЗрдЧреА
   - рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╣реИрд╢рдЯреИрдЧ (рд╣рд┐рдВрджреА рдФрд░ рдЕрдВрдЧреНрд░реЗрдЬреА рджреЛрдиреЛрдВ)

4. **рдЗрдореЛрдЬреА рдХрд╛ рдЙрдкрдпреЛрдЧ**: тЬиЁЯТкЁЯМЯЁЯФеЁЯТбЁЯМНЁЯУЪЁЯОп

5. **рдЫрд╡рд┐ рд╕реБрдЭрд╛рд╡**: рдкреЛрд╕реНрдЯ рдХреЗ рдЕрдВрдд рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдмрддрд╛рдПрдВ рдХрд┐ рдЗрд╕ рдЙрджреНрдзрд░рдг рдХреЗ рд▓рд┐рдП рдХреМрди рд╕реА рдЫрд╡рд┐ рдЙрдкрдпреБрдХреНрдд рд╣реЛрдЧреА:
   - рд╡реНрдпрдХреНрддрд┐ рдХрд╛ рдЪрд┐рддреНрд░
   - рдкреНрд░реЗрд░рдХ рдкреГрд╖реНрдарднреВрдорд┐ (рд╕реВрд░реНрдпреЛрджрдп, рдкрд╣рд╛рдбрд╝, рдЖрдХрд╛рд╢, рдЖрджрд┐)
   - рдкреНрд░рддреАрдХрд╛рддреНрдордХ рдЫрд╡рд┐ (рдХрд┐рддрд╛рдмреЗрдВ, рд░реЛрд╢рдиреА, рд░рд╛рд╕реНрддрд╛, рдЖрджрд┐)

рдлреЙрд░реНрдореЗрдЯ: Facebook рдкреЛрд╕реНрдЯ (200-250 рд╢рдмреНрдж)

рднрд╛рд╖рд╛: рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рд╣рд┐рдВрджреА, рд▓реЗрдХрд┐рди рдореВрд▓ рдЙрджреНрдзрд░рдг рдЕрдВрдЧреНрд░реЗрдЬреА рдореЗрдВ рд░рдЦреЗрдВ рдФрд░ рдлрд┐рд░ рд╣рд┐рдВрджреА рдЕрдиреБрд╡рд╛рдж рджреЗрдВред

рдЙрджрд╛рд╣рд░рдг рд╕рдВрд░рдЪрдирд╛:
"[рд╢реБрд░реБрдЖрддреА рдкрдВрдХреНрддрд┐]

[English Quote] - [Person Name]

рд╣рд┐рдВрджреА рдЕрдиреБрд╡рд╛рдж: [Hindi translation]

[рдкреНрд░реЗрд░рдХ рд╡рд┐рдЪрд╛рд░]

ЁЯУ╕ рдЫрд╡рд┐ рд╕реБрдЭрд╛рд╡: [Image suggestion]

#Motivation #Inspiration #Quotes #рд╣рд┐рдВрджреА #рдкреНрд░реЗрд░рдгрд╛"

рдкреЛрд╕реНрдЯ рдХреЛ рдкреНрд░рд╛рдорд╛рдгрд┐рдХ, рдкреНрд░реЗрд░рдХ рдФрд░ рд╣реГрджрдпрд╕реНрдкрд░реНрд╢реА рдмрдирд╛рдПрдВ!"""

        try:
            response = self.openai_client.chat.completions.create(
                model="gpt-4",
                messages=[
                    {"role": "system", "content": "рдЖрдк рдПрдХ рдкреНрд░реЗрд░рдгрд╛рджрд╛рдпрдХ рд╣рд┐рдВрджреА рд╕рд╛рдордЧреНрд░реА рдирд┐рд░реНрдорд╛рддрд╛ рд╣реИрдВ рдЬреЛ рд╡рд┐рд╢реНрд╡ рдкреНрд░рд╕рд┐рджреНрдз рдЙрджреНрдзрд░рдгреЛрдВ рдХреЛ рд╣рд┐рдВрджреА рдореЗрдВ рд╕рд╛рдЭрд╛ рдХрд░рддреЗ рд╣реИрдВред рдЖрдк рдкреНрд░рд╛рдорд╛рдгрд┐рдХ рдФрд░ рдкреНрд░рднрд╛рд╡рд╢рд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдмрдирд╛рддреЗ рд╣реИрдВред"},
                    {"role": "user", "content": prompt}
                ],
                max_tokens=800,
                temperature=0.8
            )
            
            quote_content = response.choices[0].message.content.strip()
            return quote_content
        
        except Exception as e:
            print(f"Error generating world famous quote in Hindi: {e}")
            return None
    
    def post_to_facebook(self, content):
        """Post content to Facebook Page"""
        if not self.facebook_access_token or not self.facebook_page_id:
            print("Facebook credentials not configured. Skipping Facebook post.")
            return False
        
        url = f"https://graph.facebook.com/v18.0/{self.facebook_page_id}/feed"
        
        payload = {
            'message': content,
            'access_token': self.facebook_access_token
        }
        
        try:
            response = requests.post(url, data=payload)
            
            if response.status_code == 200:
                result = response.json()
                print(f"тЬУ Successfully posted to Facebook! Post ID: {result.get('id')}")
                return True
            else:
                print(f"Error posting to Facebook: {response.status_code}")
                print(f"Response: {response.text}")
                return False
        except Exception as e:
            print(f"Error posting to Facebook: {e}")
            return False
    
    def run(self):
        """Main function to generate and post world famous quotes in Hindi"""
        print("ЁЯМН рд╡рд┐рд╢реНрд╡ рдкреНрд░рд╕рд┐рджреНрдз рдЙрджреНрдзрд░рдг рд╣рд┐рдВрджреА рдореЗрдВ рддреИрдпрд╛рд░ рдХрд░ рд░рд╣реЗ рд╣реИрдВ...")
        quote_content = self.get_world_famous_quote_hindi()
        
        if not quote_content:
            print("Failed to generate quote. Exiting.")
            return
        
        print("\n" + "="*50)
        print("Generated World Famous Quote in Hindi:")
        print("="*50)
        print(quote_content)
        print("="*50 + "\n")
        
        print("Posting to Facebook...")
        self.post_to_facebook(quote_content)
        
        print("\nтЬУ рд╡рд┐рд╢реНрд╡ рдкреНрд░рд╕рд┐рджреНрдз рдЙрджреНрдзрд░рдг рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рдкреЛрд╕реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛! ЁЯОЙтЬи")

if __name__ == "__main__":
    poster = WorldQuotesHindi()
    poster.run()
